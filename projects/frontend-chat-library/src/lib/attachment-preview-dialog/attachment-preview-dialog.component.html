<div class="dialog-container">
  <div class="dialog-header ">
    <button mat-icon-button (click)="onClose()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="carousel-container" (swipeleft)="next()" (swiperight)="previous()">
    <div class="carousel-content" [style.transform]="'translateX(-' + currentIndex * 100 + 'vw)'">
      <div *ngFor="let file of data.files; let i = index" class="carousel-item">
        <ng-container [ngSwitch]="true">
          <img *ngSwitchCase="isImage(file)" [src]="file.preview" class="carousel-image">
          <video *ngSwitchCase="isVideo(file)" [src]="file.preview" class="carousel-video" controls></video>
          <div *ngSwitchDefault class="w-full h-full bg-gray-200 flex flex-col items-center justify-center rounded">
            <mat-icon class="text-6xl" style="font-size: 120px;height: 120px;width: 120px;">description</mat-icon>
            <p class="text-lg mt-2">{{ file.file.name }}</p>
          </div>
        </ng-container>
      </div>
    </div>
    <div class="thumbnail-container">
      <div *ngFor="let file of data.files; let i = index" class="thumbnail-item" [class.active]="i === currentIndex" (click)="setCurrentIndex(i)">
        <img [src]="file.preview" class="thumbnail-image" *ngIf="isImage(file)">
        <mat-icon *ngIf="!isImage(file)"  class="thumbnail-image" style="font-size: 55px;">description</mat-icon>
      </div>
    </div>
  </div>
  <div class="dialog-footer">
    <!-- <div class="message-input-container">
      <textarea [(ngModel)]="messageText" placeholder="Type a message" class="message-input"></textarea>
      <mat-icon class="material-symbols-outlined add-more-icon" (click)="triggerFileInput()">library_add</mat-icon>
      <input type="file" #fileInput style="display: none" (change)="onFileSelected($event)" multiple>
      <button [ngStyle]="{ background: data?.config?.bgColor, color: data?.config?.textColor }" style="padding-bottom: 8px"
      class="ml-4 bg-blue-500 text-white rounded-full p-3" (click)="sendMessage()" [disabled]="!messageText.trim() && data.files.length === 0">
      <mat-icon>send</mat-icon>
    </button>
    </div> -->

    <div class="flex items-center">
      <div class="relative flex-1">
        <textarea [(ngModel)]="messageText" placeholder="Type a message"
          class="w-full border rounded-full px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          style="height: 50px; padding-right: 50px;"></textarea>
        <button mat-icon-button [matMenuTriggerFor]="attachmentMenu"  class="attachment-button absolute right-2 top-1/2 -translate-y-1/2">
          <mat-icon style="    margin-top: 13px;
    background: transparent;">library_add</mat-icon>
        </button>
          <mat-menu #attachmentMenu="matMenu" class="bg-white text-gray-800 rounded-md shadow-lg">
          <div class="flex p-3">
            <button mat-menu-item (click)="openFiles()" class="d-flex flex-col">
              <mat-icon>folder</mat-icon>
              <div>Files</div>
            </button>
            <button mat-menu-item (click)="openGallery()" class="d-flex flex-col ">
              <mat-icon>photo_library</mat-icon>
              <div>Gallery</div>
            </button>
         
          </div>
        </mat-menu>
        <input hidden type="file" #fileInput (change)="onFileSelected($event)" multiple>
      </div>
      <button [ngStyle]="{ background:data?.config?.bgColor, color: data?.config?.textColor }" style="padding-bottom: 8px"
        class="ml-4 bg-blue-500 text-white rounded-full p-3" (click)="sendMessage()">
        <mat-icon>send</mat-icon>
      </button>
    </div>
  </div>



  
</div>